---
title: 类解析-Object
date: 2021-05-18 20:50:00
updated: 2021-05-18 20:50:00
id: ml-20210518-205000-g141
categories:
	- 基础
	- CSharp类详解
tags: 
	- 基础
	- CSharp类详解
	- CSharp
---


- [System中的接口](#system中的接口)
	- [IAsyncDisposable](#iasyncdisposable)
	- [IAsyncResult](#iasyncresult)
		- [AsyncState](#asyncstate)
		- [AsyncWaitHandle](#asyncwaithandle)
		- [CompletedSynchronously](#completedsynchronously)
		- [IsCompleted](#iscompleted)
	- [ICloneable](#icloneable)
	- [IComparable](#icomparable)
- [完毕](#完毕)


<!--more-->

# System中的接口


## IAsyncDisposable

是老朋友`Disposable`的异步版本  
表示异步释放

* `DisposeAsync()`	
  * 以异步方式执行与释放或重置非托管资源相关的应用程序定义的任务。

使用此方法（而不是 `IDisposable.Dispose` ），可以在不阻止 `GUI` 应用程序的主线程的情况下执行占用大量资源的释放操作

> 异步方法与 `async` `await` 配合使用更佳

您可以在以下情况下实现 `IAsyncDisposable`

* 开发拥有非托管资源的异步枚举器时
* 释放资源需要消耗大量性能

扩展方法 `ConfigureAwait(IAsyncDisposable, Boolean)	`  
配置如何执行从异步可处置项返回的任务的等待

## IAsyncResult

表示异步操作的状态

* `AsyncState`	
  * 获取一个用户定义的对象，该对象限定或包含有关异步操作的信息。
* `AsyncWaitHandle`	
  * 获取用于等待异步操作完成的 WaitHandle。
* `CompletedSynchronously`	
  * 获取一个值，该值指示异步操作是否同步完成。
* `IsCompleted`	
  * 获取一个值，该值指示异步操作是否已完成。

### AsyncState

```C#
public object? AsyncState { get; }
```
可以看到是一个`Object`, 用户定义的任何类型都可以放在里面

### AsyncWaitHandle

```C#
public System.Threading.WaitHandle AsyncWaitHandle { get; }
```

`System.Threading.WaitHandle`有点复杂, 一般使用

* `WaitOne()`
  * 阻止当前线程，直到当前 `WaitHandle` 收到信号

### CompletedSynchronously

```C#
public bool CompletedSynchronously { get; }
```

如果在委托中检测到调用的同步完成 `AsyncCallback` ，则启动异步操作的线程可能是当前线程

例如 如果 `i/o` 请求太小, 可以直接在主线程完成

### IsCompleted

```C#
public bool IsCompleted { get; }
```

可以使用属性来轮询完成

```C#
 while(result.IsCompleted == false) {
                Thread.Sleep(250);
                Console.Write(".");
            }
```

## ICloneable

支持克隆，即用与现有实例相同的值创建类的新实例

* `Clone()`	
  * 创建作为当前实例副本的新对象

该方法旨在提供超出`Object.MemberwiseClone`的克隆支持. 即深拷贝.

建议 `ICloneable` 不要在公共 api 中实现,因为使用者并不理解此次拷贝的深度如何.

## IComparable

定义由值类型或类实现的特定于类型的通用比较方法，旨在对其实例进行排序

* `CompareTo(Object)`	
  * 将当前实例与同一类型的另一个对象进行比较，并返回一个整数，该整数指示当前实例在排序顺序中的位置是位
  于另一个对象之前、之后还是与其位置相同。

很多提供排序的方法都会要求被排序单位实现此接口

# 完毕

**感谢您的观看!**  
本文来自 [ML-Blog][ML-Blog_Link]

<!-- 图片 -->

<!-- 链接 -->

<!-- 水印 -->
[ML-Blog_Link]:https://userminghaoli.github.io/ "我的博客"
